(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const d=document.forms.ticketForm,h=document.querySelector("#addPassengers"),k=document.querySelector("#bookTicket"),f=document.querySelector("#passengerList"),v=document.querySelector("#popUp"),A=document.querySelector("#close"),S=document.querySelector("#form");document.querySelectorAll(".passenger");const $=document.querySelector("#dateOfJourneySubmited"),L=document.querySelector("#fromStationSubmited"),N=document.querySelector("#toStationSubmited"),q=document.querySelector("#trainNumSubmited"),y=document.querySelector("ol"),g=[];let p=null;h.addEventListener("click",r=>{r.preventDefault(),T(d);let e=[],s=[];[...d].forEach(n=>{n.type==="radio"&&(n.checked?(e.push(n.checked),s.push(n),n.closest(".gender-div").children[1].innerText=""):(n.closest(".gender-div").children[1].innerText="Please Select Gender",l("red",n.parentElement.parentElement)))}),s.forEach(n=>{n.checked&&c(n.closest(".gender-div").children[1],n.parentElement.parentElement)});let t=f.children.length+1;if(e[t]==!0||e[t-2]==!0){const n=document.createElement("div"),i=document.createElement("hr");i.classList.add("my-3");const a=b(t,`passenger${t}Name`,"text",`Enter passenger ${t} Name`,`Enter passenger ${t} Name`),o=["Male","Female","Others"],u=b(t,`passenger${t}Age`,"number",`Enter passenger ${t} Age`,`Enter passenger ${t} Age`);t<6?(n.append(a,O(o,t),u,i),f.append(n)):(h.nextElementSibling.textContent="You can add upto 5 Passenegrs only ",setTimeout(()=>{h.nextElementSibling.textContent=""},3e3))}});k.addEventListener("click",r=>{T(d);let e=[],s=[];[...d].forEach(t=>{t.type==="radio"&&(t.checked?(e.push(t.checked),s.push(t),t.closest(".gender-div").children[1].innerText=""):(t.closest(".gender-div").children[1].innerText="Please Select Gender",l("red",t.parentElement.parentElement)))}),s.forEach(t=>{t.checked&&c(t.closest(".gender-div").children[1],t.parentElement.parentElement)})});d.addEventListener("submit",r=>{r.preventDefault();const e=new FormData(d),s=Object.fromEntries(e);for(let o=0;o<=5;o++)s[`passenger${o}Age`]&&s[`passenger${o}Gender`]&&s[`passenger${o}Name`]&&g.push({passengerAge:s[`passenger${o}Age`],passengerGender:s[`passenger${o}Gender`],passengerName:s[`passenger${o}Name`]});const t={trainNum:s.trainNum,toStation:s.toStation,fromStation:s.fromStation,dateOfJourney:s.dateOfJourney,passengersDetails:g};p=t;const n=JSON.stringify(t);if(console.log(n),(async(o,u)=>{await fetch(u,{method:"post",headers:{"Content-Type":"application/json"},body:o})})(n,"http://localhost:3000/tickets"),p!=null&&(y.innerHTML="",$.innerText=`Date of Journey : ${p.dateOfJourney}`,L.innerText=`From : ${p.fromStation}`,N.innerText=`To : ${p.toStation}`,q.innerText=`Train no : ${p.trainNum}`,p.passengersDetails.forEach((o,u)=>{y.innerHTML+=`<li class="p-4 my-2 bg-blue-400 rounded-md"> ${u+1} .  ${o.passengerName}</li>`})),d.reset(),D(),f.children.length>1)for(let o=f.children.length;o>1;o--)f.children[o-1].remove();S.style.display="none",v.style.display="block"});d.addEventListener("change",r=>{const e=r.target,t=e.parentElement.querySelector("small");if(e.type=="text")m(e.value)?(c(t,e),x(e.value)?c(t,e):(l("red",e),t.innerText="Entered Value is  not Valid!")):(l("red",e),e.value="",e.placeholder="input cannot be blank.",t.innerText="input cannot be blank.");else if(e.type=="number")e.id=="trainNum"&&E(e.value,1e3,99999)||e.id!="trainNum"&&E(e.value,5,110)?c(t,e):(l("red",e),t.innerText="Entered Value is  not Valid!");else if(e.type=="date")m(e.value)?(l("green",e),c(t,e)):(l("red",e),t.innerText="Entered data is  not Valid!");else if(e.type=="radio"){let n=[],i=[];e.checked&&(n.push(e.checked),i.push(e)),i.forEach(a=>{a.checked&&(a.closest(".gender-div").children[1].innerText="",l("green",a.parentElement.parentElement))})}});A.addEventListener("click",()=>{S.style.display="block",v.style.display="none"});function b(r,e,s,t,n){const i=document.createElement("div"),a=document.createElement("label"),o=document.createElement("input"),u=document.createElement("small");return i.classList.add("flex","flex-col","gap-3","mt-2"),o.classList.add("passenger","p-2"),s=="number"&&e==`passenger${r}Age`&&(o.setAttribute("min",1),o.setAttribute("max",110)),a.setAttribute("for",e),o.setAttribute("type",s),o.setAttribute("id",e),o.setAttribute("name",e),o.setAttribute("placeholder",n),o.setAttribute("required","required"),a.innerText=t,i.append(a,o,u),i}function O(r,e){const s=document.createElement("div"),t=document.createElement("div"),n=document.createElement("small");s.classList.add("gender-div","space-y-2","mt-2"),t.classList.add("radio-collection","flex","justify-between","p-3");for(let i=0;i<r.length;i++)t.appendChild(C(e,r[i],r[i],r[i]));return s.append(t,n),s}function C(r,e,s,t){let n=`passenger${r}Gender`;var i=document.createElement("div"),a=document.createElement("input");a.setAttribute("type","radio"),a.setAttribute("name",n),a.setAttribute("id",`${e.toLowerCase()}${r}`),a.setAttribute("value",s.toLowerCase()),a.setAttribute("required","required"),a.style.margin="6px";var o=document.createElement("label");return o.setAttribute("for",`${e.toLowerCase()}${r}`),o.textContent=t,i.append(a,o),i}const m=r=>r.trim()!=="",x=r=>!(r.length<3),E=(r,e,s)=>!(r<e||r>s);function l(r,e){e.style.borderColor=r,e.style.borderWidth="2px"}function D(){[...d].forEach(r=>{r.type=="radio"&&(r.parentElement.parentElement.style.borderColor="none",r.parentElement.parentElement.style.borderWidth="0px"),r.style.borderColor="none",r.style.borderWidth="0px"})}function c(r,e){r.innerText="",l("green",e)}function T(r){[...r].forEach(e=>{const t=e.parentElement.querySelector("small");e.type=="text"?m(e.value)?(c(t,e),x(e.value)?c(t,e):(l("red",e),t.innerText="Entered Value is  not Valid!")):(l("red",e),e.value="",e.placeholder="input cannot be blank.",t.innerText="input cannot be blank."):e.type=="number"?e.id=="trainNum"&&E(e.value,1e3,99999)||e.id!="trainNum"&&E(e.value,5,110)?c(t,e):(l("red",e),t.innerText="Entered Value is  not Valid!"):e.type=="date"&&(m(e.value)?l("green",e):(l("red",e),t.innerText="Entered data is  not Valid!"))})}
